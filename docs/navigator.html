---

title: Navigator

keywords: fastai
sidebar: home_sidebar

summary: "CNN viewer and navigator"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_navigator.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 30.8M  100 30.8M    0     0  39.0M      0 --:--:-- --:--:-- --:--:-- 38.9M
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_row" class="doc_header"><code>get_row</code><a href="https://github.com/hallmx/fa_convnav/tree/master/fa_convnav/navigator.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_row</code>(<strong><code>l</code></strong>, <strong><code>m</code></strong>)</p>
</blockquote>
<p>Construct a convnav dataframe row from information in fastai <code>learner.named_modules()</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="find_model" class="doc_header"><code>find_model</code><a href="https://github.com/hallmx/fa_convnav/tree/master/fa_convnav/navigator.py#L101" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>find_model</code>(<strong><code>n</code></strong>)</p>
</blockquote>
<p>Returns tuple of model type and name (e.g. ('resnet', 'resnet50')) given <code>n</code>, the number of named_modules in <code>learn.model.named_modules()</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CNDF" class="doc_header"><code>class</code> <code>CNDF</code><a href="https://github.com/hallmx/fa_convnav/tree/master/fa_convnav/navigator.py#L111" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CNDF</code>(<strong><code>learner</code></strong>:<code>any</code>, <strong><code>layer_info</code></strong>:<code>tuple</code>)</p>
</blockquote>
<p>Compile information from fastai <code>learner</code> and 'layer_info(learner)` into a dataframe</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>CNDF class builds a dataframe with information froma fastai learner and fastai layer_info(learner) mathod. The resulting dataframe, called a CNDF or ConvNav dataframe, represents both the structure and information of the original model and architecture.</p>
<p>Create a new CNDF dataframe with</p>
<p><code>cndf = CNDF(learner, layer_info(learner)</code></p>
<blockquote><p>A CNDF dataframe is automatically created when a ConvNav instance is created and all the following methods are also available from within a ConvNav instance.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="CNDF.supported_models" class="doc_header"><code>CNDF.supported_models</code><a href="https://github.com/hallmx/fa_convnav/tree/master/fa_convnav/navigator.py#L249" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>CNDF.supported_models</code>()</p>
</blockquote>
<p>Prints list of supported models from 'models' list (imported from models)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="CNDF.cndf" class="doc_header"><code>CNDF.cndf</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Returns a ConvNav dataframe</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="CNDF.batch_size" class="doc_header"><code>CNDF.batch_size</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Returns the batch size of the current learner</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="CNDF.input_sizes" class="doc_header"><code>CNDF.input_sizes</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Returns the sizes (dimensions bs, ch, h, w) of the model)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="CNDF.output_dimensions" class="doc_header"><code>CNDF.output_dimensions</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Returns output dimensions of model (bs, classes)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="CNDF.model_info" class="doc_header"><code>CNDF.model_info</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Return an info string derived from<code>learn.model</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CNDFView" class="doc_header"><code>class</code> <code>CNDFView</code><a href="https://github.com/hallmx/fa_convnav/tree/master/fa_convnav/navigator.py#L258" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CNDFView</code>()</p>
</blockquote>
<p>Class to view a convnav dataframe</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="CNDFView.view" class="doc_header"><code>CNDFView.view</code><a href="https://github.com/hallmx/fa_convnav/tree/master/fa_convnav/navigator.py#L270" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>CNDFView.view</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>verbose</code></strong>=<em><code>3</code></em>, <strong><code>tight</code></strong>=<em><code>True</code></em>, <strong><code>truncate</code></strong>=<em><code>0</code></em>, <strong><code>align_cols</code></strong>=<em><code>'left'</code></em>, <strong><code>head</code></strong>=<em><code>False</code></em>, <strong><code>return_df</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Display dataframe <code>df</code> with options and styling</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Method to format and display a ConvNav dataframe. Defaults to displaying the instance dataframe built by CNDF but will accept a valid ConvNav dataframe <code>df</code> as an argument. Other arguments:</p>
<ul>
<li><code>verbose</code>: 1=Index and Layer_name columns only; 2=Model structure; 3=Model Structure and layer_info (output dims, params and frozen/unfrozen) (default); 4=includes normally hidden columns.  </li>
<li><code>tight</code>: False=normal row spacing; True=tight layout with minimal space between rows (best for large models with many rows to display). The default is True but dfs with fewer than 10 rows are automatically displayed with normal spacing.</li>
<li><code>truncate</code>: truncate number displayed columns by integer value between -10 and 10. Default=0. Negative values reveal hidden columns. Overidden when the verbose argument is set to a non-default setting.</li>
<li><code>align_cols</code>: Left (default); right</li>
<li><code>head</code>: like the pandas head method, displays 1st 10 rows only followed by a count of any undisplayed rows</li>
<li><code>return_df</code>: return the formatted df to the caller if True. False returns None (default). </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>CNDFView methods are also accessible from Convnav instances.</p>
</blockquote>
<p><code>cn = ConvNav(learner, layer_info(learner)</code></p>
<p><code>cn.view()</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CNDFSearch" class="doc_header"><code>class</code> <code>CNDFSearch</code><a href="https://github.com/hallmx/fa_convnav/tree/master/fa_convnav/navigator.py#L311" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CNDFSearch</code>()</p>
</blockquote>
<p>Class to search a convnav dataframe, display the results in a dataframe and return the matching layer objects</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="CNDFSearch.search" class="doc_header"><code>CNDFSearch.search</code><a href="https://github.com/hallmx/fa_convnav/tree/master/fa_convnav/navigator.py#L346" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>CNDFSearch.search</code>(<strong><code>searchterm</code></strong>, <strong><code>exact</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Finds any single or combination of container(s), block(s) or layer(s) in the model_df</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Searchterm</code> can be:</p>
<ul>
<li><code>int</code> : the module with Index number <code>int</code> is returned</li>
<li><code>float</code>: module(s) where <code>str(float)</code> matches the Layer_name are returned</li>
<li><code>str</code>: module(s) with <code>str</code> in one of 'Layer_name', 'Torch_class', 'Division', 'Module', 'Block', 'Layer_description' are returned. Columns are searched in this order with the search ending with the first column to make a match/matches. </li>
<li><code>dict</code>, e.g. {'col', 'str'} matches for <code>str</code> in column <code>col</code> only are returned</li>
</ul>
<p>Searchterms can also be a combined as follows:</p>
<ul>
<li><code>[101, 102, 105]</code> matches modules with the Index numbers 101, 102 and 105. Lists of floats, strings, dicts or combinations thereof are also valid searchterms.</li>
<li><code>('0.5', 'conv2d')</code> matches modules where BOTH <code>0.5</code> AND <code>conv2d</code> match. Tuples of floats, strings, dicts or combinations thereof are also valid.</li>
<li><code>{{'col1', 'str1'}, {'col2', 'str2'}}</code> matches <code>str1</code> in <code>col1</code> as well as <code>str2</code> in <code>col</code>'.</li>
</ul>
<p>Kwarg exact=True (dafault) matches searchterms exactly with column entries, otherwise (exact=False) all column entries that contain the searchterm are matches.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>CNDFSearch methods are also accessible from Convnav instances.</p>
<p><code>cn = ConvNav(learner, layer_info(learner)</code></p>
<p><code>seachterm = 128</code></p>
<p><code>cn.search(searchterm)</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ConvNav" class="doc_header"><code>class</code> <code>ConvNav</code><a href="https://github.com/hallmx/fa_convnav/tree/master/fa_convnav/navigator.py#L386" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ConvNav</code>(<strong><code>learner</code></strong>, <strong><code>layer_info</code></strong>) :: <a href="/fa_convnav/navigator#CNDF"><code>CNDF</code></a></p>
</blockquote>
<p>Class to view fastai supported CNNs, search and select module(s) and layer(s) for further investigation</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ConvNav.head" class="doc_header"><code>ConvNav.head</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Print <code>model</code> head summary info and layers</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ConvNav.body" class="doc_header"><code>ConvNav.body</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Print <code>model</code> body summary info and layers</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ConvNav.divs" class="doc_header"><code>ConvNav.divs</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Print Summary information from <code>model</code> head and body</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ConvNav.dim_transitions" class="doc_header"><code>ConvNav.dim_transitions</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Prints and returns all <code>model</code> layers which change dimensions between input and output</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finds conv layers in the model where activation dimensions change betwen input and output. Transition layers are often good points to investigate model function and <code>dim_transitions</code> returns the layer objects for attaching callbacks and hooks.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cn</span> <span class="o">=</span> <span class="n">ConvNav</span><span class="p">(</span><span class="n">learn</span><span class="p">,</span> <span class="n">layer_info</span><span class="p">(</span><span class="n">learn</span><span class="p">))</span>
<span class="n">layers</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">dim_transitions</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Densenet121
Layer dimension changes

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Layer_name</th>
      <th>Model</th>
      <th>Division</th>
      <th>Module</th>
      <th>Block</th>
      <th>Layer_description</th>
      <th>Torch_class</th>
      <th>Output_dimensions</th>
      <th>Parameters</th>
      <th>Trainable</th>
      <th>Currently</th>
    </tr>
    <tr>
      <th>Index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>0.0.conv0</td>
      <td></td>
      <td>0</td>
      <td>Conv2d</td>
      <td>conv0</td>
      <td>Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)</td>
      <td>torch.nn.modules.conv.Conv2d</td>
      <td>[128, 64, 112, 112]</td>
      <td>9408</td>
      <td>False</td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.0.1.1.conv1</td>
      <td></td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)</td>
      <td>torch.nn.modules.conv.Conv2d</td>
      <td>[128, 128, 56, 56]</td>
      <td>8192</td>
      <td>False</td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>59</th>
      <td>0.0.2.1.conv1</td>
      <td></td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)</td>
      <td>torch.nn.modules.conv.Conv2d</td>
      <td>[128, 128, 28, 28]</td>
      <td>16384</td>
      <td>False</td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>149</th>
      <td>0.0.3.1.conv1</td>
      <td></td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)</td>
      <td>torch.nn.modules.conv.Conv2d</td>
      <td>[128, 128, 14, 14]</td>
      <td>32768</td>
      <td>False</td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>323</th>
      <td>0.0.4.1.conv1</td>
      <td></td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)</td>
      <td>torch.nn.modules.conv.Conv2d</td>
      <td>[128, 128, 7, 7]</td>
      <td>65536</td>
      <td>False</td>
      <td>Frozen</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ConvNav.linear_layers" class="doc_header"><code>ConvNav.linear_layers</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Prints and returns all linear layers in the <code>model</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

